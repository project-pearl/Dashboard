@import 'mapbox-gl/dist/mapbox-gl.css';

@tailwind base;
@tailwind components;
@tailwind utilities;

/* ═══════════════════════════════════════════════════════════════════════════
   PIN Theme — CSS Variables
   ═══════════════════════════════════════════════════════════════════════════ */

@layer base {
  :root {
    /* ── shadcn core (PIN light palette) ── */
    --background: 220 20% 97%;
    --foreground: 222 47% 11%;
    --card: 0 0% 100%;
    --card-foreground: 222 47% 11%;
    --popover: 0 0% 100%;
    --popover-foreground: 222 47% 11%;
    --primary: 174 42% 33%;
    --primary-foreground: 0 0% 100%;
    --secondary: 220 14% 96%;
    --secondary-foreground: 222 47% 11%;
    --muted: 220 14% 96%;
    --muted-foreground: 215 16% 47%;
    --accent: 220 14% 96%;
    --accent-foreground: 222 47% 11%;
    --destructive: 0 84% 60%;
    --destructive-foreground: 0 0% 100%;
    --border: 220 13% 91%;
    --input: 220 13% 91%;
    --ring: 174 42% 33%;
    --chart-1: 174 42% 33%;
    --chart-2: 24 60% 50%;
    --chart-3: 197 37% 24%;
    --chart-4: 43 74% 66%;
    --chart-5: 27 87% 67%;
    --radius: 0.5rem;

    /* ── PIN custom properties (light) ── */
    --pin-teal: #1A9A8E;
    --pin-copper: #B87333;
    --pin-page-bg: #F5F7FA;
    --pin-sidebar-bg: #FFFFFF;
    --pin-text-bright: #0F172A;
    --pin-text-primary: #1E293B;
    --pin-text-secondary: #475569;
    --pin-text-dim: #94A3B8;
    --pin-status-healthy: #10B981;
    --pin-status-watch: #F59E0B;
    --pin-status-impaired: #F97316;
    --pin-status-severe: #EF4444;
  }

  .dark {
    /* ── shadcn core (PIN dark palette — deep navy) ── */
    --background: 223 56% 7%;
    --foreground: 213 32% 95%;
    --card: 224 52% 12%;
    --card-foreground: 213 32% 95%;
    --popover: 224 52% 12%;
    --popover-foreground: 213 32% 95%;
    --primary: 174 52% 47%;
    --primary-foreground: 223 56% 7%;
    --secondary: 224 40% 16%;
    --secondary-foreground: 213 32% 95%;
    --muted: 224 40% 16%;
    --muted-foreground: 217 18% 56%;
    --accent: 224 40% 16%;
    --accent-foreground: 213 32% 95%;
    --destructive: 0 62% 30%;
    --destructive-foreground: 213 32% 95%;
    --border: 174 52% 47% / 0.12;
    --input: 174 52% 47% / 0.12;
    --ring: 174 52% 47%;
    --chart-1: 174 52% 47%;
    --chart-2: 24 60% 55%;
    --chart-3: 197 50% 40%;
    --chart-4: 43 74% 66%;
    --chart-5: 27 87% 67%;

    /* ── PIN custom properties (dark) ── */
    --pin-teal: #3ABDB0;
    --pin-copper: #D4915A;
    --pin-page-bg: #0A1128;
    --pin-sidebar-bg: #0D1526;
    --pin-text-bright: #F0F4F8;
    --pin-text-primary: #D1DCE8;
    --pin-text-secondary: #7A8BA8;
    --pin-text-dim: #3A4A64;
    --pin-status-healthy: #34D399;
    --pin-status-watch: #FBBF24;
    --pin-status-impaired: #FB923C;
    --pin-status-severe: #F87171;
  }
}

@layer base {
  * {
    @apply border-border;
  }
  body {
    @apply bg-background text-foreground;
  }
}

/* ═══════════════════════════════════════════════════════════════════════════
   PIN Design Token Layer — semantic CSS variables for light/dark
   ═══════════════════════════════════════════════════════════════════════════ */

:root {
  --bg-base: #F5F7FA;
  --bg-surface: #FFFFFF;
  --bg-card: rgba(255, 255, 255, 0.92);
  --bg-elevated: #FFFFFF;
  --bg-hover: rgba(0, 0, 0, 0.03);
  --bg-input: #F0F2F5;
  --border-default: rgba(0, 0, 0, 0.08);
  --border-subtle: rgba(0, 0, 0, 0.05);
  --border-strong: rgba(0, 0, 0, 0.15);
  --text-bright: #0F172A;
  --text-primary: #334155;
  --text-secondary: #64748B;
  --text-dim: #94A3B8;
  --accent-teal: #1A9A8E;
  --accent-teal-glow: rgba(26, 154, 142, 0.08);
  --accent-copper: #A67A45;
  --accent-copper-glow: rgba(166, 122, 69, 0.08);
  --status-healthy: #5E9A6F;
  --status-healthy-bg: rgba(94, 154, 111, 0.07);
  --status-warning: #A89055;
  --status-warning-bg: rgba(168, 144, 85, 0.07);
  --status-watch: #A89055;
  --status-watch-bg: rgba(168, 144, 85, 0.07);
  --status-impaired: #A89055;
  --status-impaired-bg: rgba(168, 144, 85, 0.07);
  --status-severe: #C53030;
  --status-severe-bg: rgba(197, 48, 48, 0.07);
  --shadow-card: 0 1px 2px rgba(0,0,0,0.04), 0 2px 6px rgba(0,0,0,0.03), 0 4px 12px rgba(0,0,0,0.02);
  --shadow-elevated: 0 2px 4px rgba(0,0,0,0.04), 0 8px 16px rgba(0,0,0,0.06), 0 16px 32px rgba(0,0,0,0.04);
  --border-highlight: rgba(255,255,255,0.9);
  --pill-bg: #FFFFFF;
  --pill-bg-active: #1B2A4A;
  --pill-text: #64748B;
  --pill-text-active: #FFFFFF;
  --pill-border: rgba(0,0,0,0.10);
  --pill-border-active: #1B2A4A;
}

[data-theme="dark"] {
  --bg-base: #0A1128;
  --bg-surface: rgba(14, 22, 45, 0.85);
  --bg-card: rgba(16, 26, 52, 0.72);
  --bg-elevated: rgba(22, 34, 62, 0.8);
  --bg-hover: rgba(58, 189, 176, 0.06);
  --bg-input: rgba(16, 26, 52, 0.6);
  --border-default: rgba(58, 189, 176, 0.12);
  --border-subtle: rgba(58, 189, 176, 0.06);
  --border-strong: rgba(58, 189, 176, 0.20);
  --text-bright: #F0F4F8;
  --text-primary: #CBD5E1;
  --text-secondary: #7A8BA8;
  --text-dim: #4A5A74;
  --accent-teal: #3ABDB0;
  --accent-teal-glow: rgba(58, 189, 176, 0.12);
  --accent-copper: #D4A56A;
  --accent-copper-glow: rgba(212, 165, 106, 0.12);
  --status-healthy: #6EAA7E;
  --status-healthy-bg: rgba(110, 170, 126, 0.08);
  --status-warning: #C4B06A;
  --status-warning-bg: rgba(196, 176, 106, 0.08);
  --status-watch: #C4B06A;
  --status-watch-bg: rgba(196, 176, 106, 0.08);
  --status-impaired: #C4B06A;
  --status-impaired-bg: rgba(196, 176, 106, 0.08);
  --status-severe: #D45050;
  --status-severe-bg: rgba(212, 80, 80, 0.08);
  --shadow-card: 0 1px 2px rgba(0,0,0,0.3), 0 2px 8px rgba(0,0,0,0.2), 0 0 1px rgba(255,255,255,0.04);
  --shadow-elevated: 0 2px 4px rgba(0,0,0,0.3), 0 8px 20px rgba(0,0,0,0.3), 0 16px 40px rgba(0,0,0,0.2);
  --border-highlight: rgba(255,255,255,0.06);
  --pill-bg: rgba(22, 34, 62, 0.8);
  --pill-bg-active: #3ABDB0;
  --pill-text: #7A8BA8;
  --pill-text-active: #0A1128;
  --pill-border: rgba(58, 189, 176, 0.12);
  --pill-border-active: #3ABDB0;
}

/* ── Smooth theme transitions (split timings for refined feel) ── */
*, *::before, *::after {
  transition: background-color 300ms ease, border-color 300ms ease,
              color 250ms ease, box-shadow 350ms ease,
              transform 200ms ease;
}
canvas, video, iframe, .no-theme-transition {
  transition: none !important;
}

/* ═══════════════════════════════════════════════════════════════════════════
   PIN Dark Override Layer
   Handles ~80% of hardcoded Tailwind color classes without touching components
   ═══════════════════════════════════════════════════════════════════════════ */

/* ── Background overrides ── */
.dark .bg-white {
  background-color: rgba(14, 22, 45, 0.85) !important;
}
.dark .bg-slate-50 {
  background-color: rgba(14, 22, 45, 0.5) !important;
}
.dark .bg-slate-100 {
  background-color: rgba(14, 22, 45, 0.6) !important;
}
.dark .bg-gray-50 {
  background-color: rgba(14, 22, 45, 0.5) !important;
}
.dark .bg-gray-100 {
  background-color: rgba(14, 22, 45, 0.6) !important;
}

/* ── Text overrides (invert the slate scale) ── */
.dark .text-slate-900 { color: #F0F4F8 !important; }
.dark .text-slate-800 { color: #D1DCE8 !important; }
.dark .text-slate-700 { color: #B0BDD0 !important; }
.dark .text-slate-600 { color: #7A8BA8 !important; }
.dark .text-slate-500 { color: #5A6B84 !important; }
.dark .text-slate-400 { color: #4A5A74 !important; }
.dark .text-slate-300 { color: #3A4A64 !important; }
.dark .text-gray-900 { color: #F0F4F8 !important; }
.dark .text-gray-800 { color: #D1DCE8 !important; }
.dark .text-gray-700 { color: #B0BDD0 !important; }
.dark .text-gray-600 { color: #7A8BA8 !important; }
.dark .text-gray-500 { color: #5A6B84 !important; }
.dark .text-gray-400 { color: #4A5A74 !important; }

/* ── Border overrides (teal-tinted) ── */
.dark .border-slate-100 { border-color: rgba(58, 189, 176, 0.08) !important; }
.dark .border-slate-200 { border-color: rgba(58, 189, 176, 0.12) !important; }
.dark .border-slate-300 { border-color: rgba(58, 189, 176, 0.16) !important; }
.dark .border-gray-100 { border-color: rgba(58, 189, 176, 0.08) !important; }
.dark .border-gray-200 { border-color: rgba(58, 189, 176, 0.12) !important; }
.dark .border-gray-300 { border-color: rgba(58, 189, 176, 0.16) !important; }

/* ── Shadow overrides (pure dark elevation, no teal glow) ── */
.dark .shadow-sm {
  box-shadow: 0 1px 3px rgba(2, 6, 23, 0.5), 0 0 1px rgba(255, 255, 255, 0.03) !important;
}
.dark .shadow-md,
.dark .shadow {
  box-shadow: 0 4px 12px rgba(2, 6, 23, 0.6), 0 0 1px rgba(255, 255, 255, 0.04) !important;
}
.dark .shadow-lg {
  box-shadow: 0 8px 24px rgba(2, 6, 23, 0.7), 0 0 1px rgba(255, 255, 255, 0.05) !important;
}

/* ── Colored light backgrounds → dark tinted surfaces ── */
.dark .bg-blue-50 { background-color: rgba(14, 22, 45, 0.4) !important; }
.dark .bg-cyan-50 { background-color: rgba(14, 22, 45, 0.4) !important; }
.dark .bg-amber-50 { background-color: rgba(14, 22, 45, 0.4) !important; }
.dark .bg-emerald-50 { background-color: rgba(14, 22, 45, 0.4) !important; }
.dark .bg-green-50 { background-color: rgba(14, 22, 45, 0.4) !important; }
.dark .bg-red-50 { background-color: rgba(14, 22, 45, 0.4) !important; }
.dark .bg-orange-50 { background-color: rgba(14, 22, 45, 0.4) !important; }
.dark .bg-yellow-50 { background-color: rgba(14, 22, 45, 0.4) !important; }
.dark .bg-purple-50 { background-color: rgba(14, 22, 45, 0.4) !important; }
.dark .bg-violet-50 { background-color: rgba(14, 22, 45, 0.4) !important; }
.dark .bg-indigo-50 { background-color: rgba(14, 22, 45, 0.4) !important; }
.dark .bg-teal-50 { background-color: rgba(14, 22, 45, 0.4) !important; }
.dark .bg-sky-50 { background-color: rgba(14, 22, 45, 0.4) !important; }
.dark .bg-lime-50 { background-color: rgba(14, 22, 45, 0.4) !important; }
.dark .bg-rose-50 { background-color: rgba(14, 22, 45, 0.4) !important; }
.dark .bg-pink-50 { background-color: rgba(14, 22, 45, 0.4) !important; }

/* -100 backgrounds → subtle hue-tinted */
.dark .bg-blue-100 { background-color: rgba(59, 130, 246, 0.15) !important; }
.dark .bg-cyan-100 { background-color: rgba(6, 182, 212, 0.15) !important; }
.dark .bg-amber-100 { background-color: rgba(245, 158, 11, 0.15) !important; }
.dark .bg-emerald-100 { background-color: rgba(16, 185, 129, 0.15) !important; }
.dark .bg-green-100 { background-color: rgba(34, 197, 94, 0.15) !important; }
.dark .bg-red-100 { background-color: rgba(239, 68, 68, 0.15) !important; }
.dark .bg-orange-100 { background-color: rgba(249, 115, 22, 0.15) !important; }
.dark .bg-yellow-100 { background-color: rgba(234, 179, 8, 0.15) !important; }
.dark .bg-purple-100 { background-color: rgba(168, 85, 247, 0.15) !important; }
.dark .bg-violet-100 { background-color: rgba(139, 92, 246, 0.15) !important; }
.dark .bg-indigo-100 { background-color: rgba(99, 102, 241, 0.15) !important; }
.dark .bg-teal-100 { background-color: rgba(20, 184, 166, 0.15) !important; }
.dark .bg-sky-100 { background-color: rgba(14, 165, 233, 0.15) !important; }
.dark .bg-lime-100 { background-color: rgba(132, 204, 22, 0.15) !important; }
.dark .bg-rose-100 { background-color: rgba(244, 63, 94, 0.15) !important; }
.dark .bg-pink-100 { background-color: rgba(236, 72, 153, 0.15) !important; }

/* ── Colored borders → tinted ── */
.dark .border-blue-200 { border-color: rgba(59, 130, 246, 0.25) !important; }
.dark .border-cyan-200 { border-color: rgba(6, 182, 212, 0.25) !important; }
.dark .border-amber-200 { border-color: rgba(245, 158, 11, 0.25) !important; }
.dark .border-emerald-200 { border-color: rgba(16, 185, 129, 0.25) !important; }
.dark .border-green-200 { border-color: rgba(34, 197, 94, 0.25) !important; }
.dark .border-red-200 { border-color: rgba(239, 68, 68, 0.25) !important; }
.dark .border-orange-200 { border-color: rgba(249, 115, 22, 0.25) !important; }
.dark .border-yellow-200 { border-color: rgba(234, 179, 8, 0.25) !important; }
.dark .border-purple-200 { border-color: rgba(168, 85, 247, 0.25) !important; }
.dark .border-violet-200 { border-color: rgba(139, 92, 246, 0.25) !important; }
.dark .border-indigo-200 { border-color: rgba(99, 102, 241, 0.25) !important; }
.dark .border-teal-200 { border-color: rgba(20, 184, 166, 0.25) !important; }
.dark .border-sky-200 { border-color: rgba(14, 165, 233, 0.25) !important; }
.dark .border-lime-200 { border-color: rgba(132, 204, 22, 0.25) !important; }
.dark .border-rose-200 { border-color: rgba(244, 63, 94, 0.25) !important; }
.dark .border-pink-200 { border-color: rgba(236, 72, 153, 0.25) !important; }

/* ── Colored text (adjust -700 tones for dark readability) ── */
.dark .text-blue-700 { color: #60A5FA !important; }
.dark .text-cyan-700 { color: #22D3EE !important; }
.dark .text-amber-700 { color: #FBBF24 !important; }
.dark .text-emerald-700 { color: #34D399 !important; }
.dark .text-green-700 { color: #4ADE80 !important; }
.dark .text-red-700 { color: #F87171 !important; }
.dark .text-orange-700 { color: #FB923C !important; }
.dark .text-purple-700 { color: #C084FC !important; }
.dark .text-violet-700 { color: #A78BFA !important; }
.dark .text-indigo-700 { color: #818CF8 !important; }
.dark .text-teal-700 { color: #2DD4BF !important; }
.dark .text-sky-700 { color: #38BDF8 !important; }
.dark .text-lime-700 { color: #A3E635 !important; }
.dark .text-rose-700 { color: #FB7185 !important; }
.dark .text-pink-700 { color: #F472B6 !important; }

/* ── Kill page gradients in dark mode ── */
.dark [class*="from-indigo-50"],
.dark [class*="from-blue-50"],
.dark [class*="from-slate-50"],
.dark [class*="from-white"] {
  --tw-gradient-from: transparent !important;
  --tw-gradient-to: transparent !important;
  --tw-gradient-stops: transparent !important;
}

/* ── Hover overrides ── */
.dark .hover\:bg-slate-50:hover { background-color: rgba(58, 189, 176, 0.08) !important; }
.dark .hover\:bg-slate-100:hover { background-color: rgba(58, 189, 176, 0.12) !important; }
.dark .hover\:bg-slate-200:hover { background-color: rgba(58, 189, 176, 0.16) !important; }
.dark .hover\:bg-gray-50:hover { background-color: rgba(58, 189, 176, 0.08) !important; }
.dark .hover\:bg-gray-100:hover { background-color: rgba(58, 189, 176, 0.12) !important; }

/* ── Hover text ── */
.dark .hover\:text-slate-900:hover { color: #F0F4F8 !important; }
.dark .hover\:text-slate-700:hover { color: #B0BDD0 !important; }
.dark .hover\:text-slate-600:hover { color: #7A8BA8 !important; }

/* ── Ring / focus overrides ── */
.dark .ring-slate-200 { --tw-ring-color: rgba(58, 189, 176, 0.12) !important; }
.dark .focus\:ring-slate-200:focus { --tw-ring-color: rgba(58, 189, 176, 0.12) !important; }

/* ── Divide overrides ── */
.dark .divide-slate-100 > :not([hidden]) ~ :not([hidden]) { border-color: rgba(58, 189, 176, 0.08) !important; }
.dark .divide-slate-200 > :not([hidden]) ~ :not([hidden]) { border-color: rgba(58, 189, 176, 0.12) !important; }
.dark .divide-gray-100 > :not([hidden]) ~ :not([hidden]) { border-color: rgba(58, 189, 176, 0.08) !important; }
.dark .divide-gray-200 > :not([hidden]) ~ :not([hidden]) { border-color: rgba(58, 189, 176, 0.12) !important; }

/* ── Status pill overrides (keep hues recognizable) ── */
.dark .text-emerald-600 { color: #34D399 !important; }
.dark .text-emerald-500 { color: #34D399 !important; }
.dark .bg-emerald-50 { background-color: rgba(16, 185, 129, 0.1) !important; }
.dark .border-emerald-200 { border-color: rgba(16, 185, 129, 0.2) !important; }

/* ── Card token layer (applies to all cards globally) ── */
[data-theme="dark"] .bg-white,
[data-theme="dark"] [class*="bg-card"] {
  background: var(--bg-surface) !important;
  border-color: var(--border-default);
  box-shadow: var(--shadow-card);
}

/* ── Strip noisy colored borders from cards (use subtle border instead) ── */
.bg-card.border-2 {
  border-width: 1px !important;
  border-color: var(--border-default) !important;
}
.bg-card[class*="bg-gradient"] {
  background: hsl(var(--card)) !important;
}
[data-theme="dark"] .bg-card[class*="bg-gradient"] {
  background: var(--bg-surface) !important;
}

/* ── Scrollbar styling for dark mode ── */
.dark ::-webkit-scrollbar { width: 6px; height: 6px; }
.dark ::-webkit-scrollbar-track { background: rgba(14, 22, 45, 0.3); }
.dark ::-webkit-scrollbar-thumb { background: rgba(58, 189, 176, 0.2); border-radius: 3px; }
.dark ::-webkit-scrollbar-thumb:hover { background: rgba(58, 189, 176, 0.35); }

/* ═══════════════════════════════════════════════════════════════════════════
   PIN Utility Classes
   ═══════════════════════════════════════════════════════════════════════════ */

@layer components {
  .pin-card-glass {
    @apply rounded-[14px] border;
    background: var(--bg-surface);
    border-color: var(--border-default);
    box-shadow: var(--shadow-card);
    backdrop-filter: blur(20px);
    -webkit-backdrop-filter: blur(20px);
  }

  /* ── PIN Typography ── */

  /* Primary headline metric: largest, heaviest, JetBrains Mono */
  .pin-stat-hero {
    font-family: var(--font-mono), ui-monospace, monospace;
    font-variant-numeric: tabular-nums;
    font-weight: 800;
    letter-spacing: -0.03em;
    color: var(--text-bright);
    line-height: 1.1;
  }

  /* Standard stat value: JetBrains Mono, neutral by default */
  .pin-stat-value {
    font-family: var(--font-mono), ui-monospace, monospace;
    font-variant-numeric: tabular-nums;
    font-weight: 800;
    letter-spacing: -0.03em;
    color: var(--text-bright);
  }

  /* Secondary stat: smaller, lighter weight, lower contrast */
  .pin-stat-secondary {
    font-family: var(--font-mono), ui-monospace, monospace;
    font-variant-numeric: tabular-nums;
    font-weight: 600;
    letter-spacing: -0.02em;
    color: var(--text-secondary);
  }

  /* Labels: quiet, uppercase, below numbers */
  .pin-label {
    font-size: 10px;
    font-weight: 500;
    text-transform: uppercase;
    letter-spacing: 0.06em;
    color: var(--text-dim);
  }

  /* Section sub-headers */
  .pin-section-label {
    font-size: 11px;
    font-weight: 600;
    text-transform: uppercase;
    letter-spacing: 0.05em;
    color: var(--text-dim);
  }

  /* ── PIN Card Depth ── */
  .pin-card-inset {
    @apply rounded-[10px];
    background: var(--bg-card);
    border: 1px solid var(--border-subtle);
    box-shadow: inset 0 1px 2px rgba(0,0,0,0.03);
  }
  [data-theme="dark"] .pin-card-inset {
    box-shadow: inset 0 1px 3px rgba(0,0,0,0.15);
  }

  /* ── Card hover interaction ── */
  .pin-card-hover {
    transition: transform 200ms ease, box-shadow 350ms ease;
  }
  .pin-card-hover:hover {
    transform: translateY(-1px);
    box-shadow: var(--shadow-elevated);
  }

  /* ── Stat tile: quiet container for a number + label ── */
  .pin-stat-tile {
    @apply rounded-lg text-center;
    padding: 12px 8px;
    background: var(--bg-surface);
    border: 1px solid var(--border-subtle);
  }
}
